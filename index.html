<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>School Management - Home</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="style.css">
    </head>
    <body data-page="home">
        <div class="banner">
            <div class="navbar">
                <img src="logo.jpg" class="logo" alt="School Logo">
                <ul class="nav" role="menubar">
                    <li><a class="active" href="index.html">Home</a></li>
                    <li><a href="attendance.html">Attendance</a></li>
                    <li><a href="students.html">Students</a></li>
                    <li><a href="classes.html">Classes</a></li>
                    <li><a href="assignments.html">Assignments</a></li>
                    <li><a href="exams.html">Exams</a></li>
                    <li><a href="reports.html">Reports</a></li>
                    <li><a href="settings.html">Settings</a></li>
                    
                </ul>
                <button id="toggleTheme" class="btn btn-sm btn-outline-light ms-auto" aria-label="Toggle theme">Dark</button>
            </div>

            <div class="content container">
                <h1>School Dashboard</h1>
                <p>Manage attendance, grades, assignments, and reports. Use the navigation to explore.</p>

                <div class="toolbar">
                    <div class="search">
                        <span class="emoji">ðŸ”Ž</span>
                        <input type="text" id="searchHome" placeholder="Search (students, classes, sections)">
                    </div>
                    <div class="counter" id="homeCountClasses">Classes: --</div>
                    <div class="counter present" id="homeCountPresent">Present: --</div>
                    <div class="counter absent" id="homeCountAbsent">Absent: --</div>
                </div>

                <div class="row g-3 mt-2">
                    <div class="col-12 col-md-3">
                        <a class="tile" href="attendance.html"><span></span>Mark Attendance</a>
                    </div>
                    <div class="col-12 col-md-3">
                        <a class="tile" href="assignments.html"><span></span>Manage Assignments</a>
                    </div>
                    <div class="col-12 col-md-3">
                        <a class="tile" href="reports.html"><span></span>View Reports</a>
                    </div>
                    
                </div>

                <div class="summary mt-4">
                    <h2>Today</h2>
                    <div class="cards">
                        <div class="card metric-card">
                            <div class="metric" id="sumTotal">--</div>
                            <div class="label">Total Students</div>
                        </div>
                        <div class="card metric-card">
                            <div class="metric" id="sumPresent">--</div>
                            <div class="label">Present</div>
                        </div>
                        <div class="card metric-card">
                            <div class="metric" id="sumAbsent">--</div>
                            <div class="label">Absent</div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4 g-4">
                    <div class="col-12 col-lg-6">
                        <div class="panel">
                            <div class="panel-header">Attendance Overview</div>
                            <canvas id="attendanceChart" height="160"></canvas>
                        </div>
                    </div>
                    <div class="col-12 col-lg-6">
                        <div class="panel">
                            <div class="panel-header">Grades Overview</div>
                            <canvas id="gradesChart" height="160"></canvas>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
        <script src="scripts.js"></script>
        <script>
        (function(){
            try {
                const students = JSON.parse(localStorage.getItem('students')||'[]');
                const total = students.length;
                const classesSet = new Set(students.map(function(s){ return s.className; }).filter(Boolean));
                const todayKey = 'attendance_' + new Date().toISOString().split('T')[0];
                const attendance = JSON.parse(localStorage.getItem(todayKey) || '[]');
                const present = attendance.filter(function(a){ return !!a.present; }).length;
                const absent = attendance.filter(function(a){ return !a.present; }).length;

                document.getElementById('homeCountClasses').textContent = 'Classes: ' + classesSet.size;
                document.getElementById('homeCountPresent').textContent = 'Present: ' + present;
                document.getElementById('homeCountAbsent').textContent = 'Absent: ' + absent;
                document.getElementById('sumTotal').textContent = total;
                document.getElementById('sumPresent').textContent = present;
                document.getElementById('sumAbsent').textContent = absent;
            } catch(e){
                // Fallback to zeros if any error
                document.getElementById('homeCountClasses').textContent = 'Classes: 0';
                document.getElementById('homeCountPresent').textContent = 'Present: 0';
                document.getElementById('homeCountAbsent').textContent = 'Absent: 0';
                document.getElementById('sumTotal').textContent = 0;
                document.getElementById('sumPresent').textContent = 0;
                document.getElementById('sumAbsent').textContent = 0;
            }
        })();
        </script>
    </body>
</html>


